# tinyproto
The aim of this tool to build small fast protobuf parsers for Typescript which lead to minimal page bloat, while allowing the addition of extensions which are specified in
the proto file. Parsers generated by the tool will be naive - there is no 64-bit number support, and no attempt at validation. These parsers are not guaranteed to follow the Protobuf spec at all. 

If you have any issues with the output of this tool then switch to using a more complete and compliant tool such as the google-provided JS one or 
https://github.com/dcodeIO/ProtoBuf.js/

##Usage
```
java -jar target/proto-0.0.1-SNAPSHOT.jar [OPTIONS] <PROTO FILE PATH/FILENAME> 
```
Options:
	--proto-out=<MODIFIED PROTO FILE PATH/NAME>
	--ts-out=<TYPESCRIPT FILE PATH/NAME>
	--ts-imports=<TYPESCRIPT FILE PATH/NAME>
	--[proto|ts]-include-classes=<LIST OF MESSAGES TO OUTPUT CLASSES FOR>
	--ts-include-builders=<LIST OF MESSAGES TO OUTPUT BUILDERS FOR>
	--ts-include-parsers=<LIST OF MESSAGES TO OUTPUT PARSERS FOR>
	--[proto|ts]-include-classes=<LIST OF MESSAGES NOT TO OUTPUT CLASSES FOR>
	--ts-include-builders=<LIST OF MESSAGES NOT TO OUTPUT BUILDERS FOR>
	--ts-include-parsers=<LIST OF MESSAGES NOT TO OUTPUT PARSERS FOR>

##Features
* Small file size, and fast run speed which is crucial to using protobuf format data in bulk on page load. 
* The parsers and therefore the created entity classes can be extended, making it easier to inject additional functionality to them
* ```divide``` and ```subtract``` options allow you to create tighter encoding of integers. For example if you want to encode milliseconds, which are standard time units in Java and JS, but only actually need 30-second accuracy you can just set a divisor of 30000, or if you have are passing a positive integer value result where -1 represents an error condition you can set a subtract of -1, saving the need to expensively use signed varints. Divide happens before subtract
* Not implemented yet: a ```decimalPlaces``` option will allow you to code decimals as integers. Minimal implementation in Java will use BigDecimal. In JS will just expose the decimal places as a constant, but ideally the ability will be added to instantiate \a type from a library 

##Architecture
Generation is done by feeding a .proto file into a Java parser. This was developed using Antlr 4. The .g4 file for parsing .proto files was adapted from an Antlr 3 grammar provided in another OS project, which will be credited as soon as I find a link. This approach should allow addition of other languages. I'd like to produce a smaller footprint Java library with Java 8 
support for example

##Build
* Obtain the source
* bulid using ```mvn package```	

##To do:
* Support a 64-bit library for very large numbers
* Support Fixed-width numbers
* Add decimal support
* Tests on the ts generation code
* Javascript code generator (should be pretty easy)
* Java code generator